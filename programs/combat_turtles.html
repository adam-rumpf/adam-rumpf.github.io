<!DOCTYPE html>
<html lang="en-us">
<head>
	<!-- Metadata -->
	<meta charset="utf-8">
	<title>Adam Rumpf: Combat Turtles</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="Adam Rumpf">
	<meta name="description" content="Adam Rumpf: Combat Turtles Python programming game">
	<link rel="stylesheet" href="../styles.css">
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
	<base href="https://adam-rumpf.github.io/">
	
	<!-- KaTeX -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
	<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
	<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
</head>

<body>
	<header>
		Adam Rumpf: Math Person
	</header>
	
	<div class="navbar">
		<a href="https://adam-rumpf.github.io/">Home</a>
		<a href="cv.html">CV</a>
		<a href="teaching.html">Teaching</a>
		<a href="research.html">Research</a>
		<div class="dropdown">
			<button class="dropbtn" id="current">
				Programs...
			</button>
			<div class="dropdown-content">
				<p><a href="programs/mathematica.html">Mathematica Class Demonstrations</a></p>
				<p><a href="programs/turtle_combat.html" id="current">Combat Turtles</a></p>
				<p><a href="programs/gamemaker_scripts.html">GameMaker Scripts</a></p>
				<p><a href="programs/logic_circuits.html">Logic Circuits</a></p>
				<p><a href="programs/slight_misspeller.html">Slight Misspeller</a></p>
			</div>
		</div>
		<div class="dropdown">
			<button class="dropbtn">
				Games...
			</button>
			<div class="dropdown-content">
				<p><a href="games/cellular_automata.html">Cellular Automata Playground</a></p>
				<p><a href="games/chromagraph.html">Chromagraph</a></p>
				<p><a href="games/topological_asteroids.html">Topological Asteroids</a></p>
				<p><a href="games/steepest_descent.html">Steepest Descent</a></p>
			</div>
		</div>
		<a href="papercraft.html">Papercraft</a>
		<a href="links.html">Links</a>
	</div>
	
	<br/>
	
	<h1>Combat Turtles</h1>
	
	<p><iframe src="https://itch.io/embed/810293?linkback=true&amp;bg_color=19232d&amp;fg_color=b0e686&amp;link_color=ce473a&amp;border_color=4c555f" width="552" height="167" frameborder="0"><a href="https://adam-rumpf.itch.io/combat-turtles">Combat Turtles by Adam Rumpf</a></iframe></p>
	
	<p><a href="https://github.com/adam-rumpf/combat-turtles"><img src="images/github/GitHub_Logo.png" alt="GitHub Link" title="GitHub Link" width="300px"/></a></p>
	
	<p>This is a <a href="https://www.python.org/">Python</a> module for programming <a href="https://en.wikipedia.org/wiki/Turtle_(robot)">turtle robots</a> to compete against each other in arena combat. See the online documentation <a href="https://adam-rumpf.github.io/combat-turtles/">here</a> for a complete guide.</p>
	
	<p><i>Combat Turtles</i> is meant as a learning tool for intermediate-level Python students. It defines a combat game in which programmable turtle robots move around a battlefield firing missiles to destroy each other. A parent class, <code>TurtleParent</code>, defines a variety of basic attributes and methods for these turtle robots, and an <code>ai/</code> folder contains a variety of subclasses of this parent class which define different turtle AIs. The main driver script <code>combatturtles.py</code> loads selected AI subclasses to compete against each other in combat.</p>
	
	<p>The player can create their own turtle AIs by extending the <code>TurtleParent</code> class and overwriting a few key methods. The game is run using discrete step events (at a rate of approximately 30 steps/second), with each turtle defining its actions on a per-step basis. Custom AI submodules (in the form of standalone <code>.py</code> files) can be added to the <code>ai/</code> directory to import the player's AI into the game. Several example and template subclasses are included in this directory to get the player started. Python students might enjoy competing against each other to see whom can come up with the best AI, while Python instructors might consider running a class tournament to encourage students to learn more about object-oriented programming.</p>
	
	<h2>Screenshots</h2>
	
	<p class="center"><img src="https://github.com/adam-rumpf/combat-turtles/raw/master/images/screenshot_wall.png" height="250px"/> <img src="https://github.com/adam-rumpf/combat-turtles/raw/master/images/screenshot_column.png" height="250px"/> <img src="https://github.com/adam-rumpf/combat-turtles/raw/master/images/screenshot_explosion.png" height="250px"/></p>
	
	<h2>Project Background</h2>
	
	<p>When I was but a mere larval game developer, I stumbled upon a game which was meant as an educational tool to get students interested in programming and AI design. It was an arena combat game in which two robots could move around and shoot projectiles at each other, and the player could write their own AI script to determine each robot's behavior. Then I swiftly forgot about it before actually bothering to write any AI scripts. (I also don't remember what the game is and have been unable to find it since. I want to say that it was developed in <a href="http://www.3dgamestudio.com/">3D Game Studio</a>? Boy, I'm a great raconteur.) But apparently some aspect of the project has haunted my brain for all these years, and I've wanted to make something like it since I started teaching computer science.</p>
	
	<p class="center"><img src="images/combat_turtles/square_spiral.png" height="250" title="Square spiral."/></p>
	
	<p>I've had the opportunity to teach a few <a href="https://www.python.org/">Python</a> classes, and part of the introductory curriculum involves using the built-in <a href="https://docs.python.org/3/library/turtle.html">turtle</a> module to program virtual <a href="https://en.wikipedia.org/wiki/Turtle_(robot)">turtle robots</a> to move around the screen and draw shapes. <a href="https://en.wikipedia.org/wiki/Turtle_graphics">Turtle graphics</a> have long been a popular educational tool to get students interested in programming (which is why they're included in the <a href="https://docs.python.org/3/library/">Python Standard Library</a>). They're cool to work with, they can create pretty pictures, and they provide a lot of visual feedback to help students to tie their program to a physical result in a way that pure text programs do not. They even have a connection to my favorite thing, <a href="https://en.wikipedia.org/wiki/Koch_snowflake">fractals</a>, via the <a href="https://en.wikipedia.org/wiki/Thue%E2%80%93Morse_sequence#Fractals_and_turtle_graphics">Thue-Morse sequence</a>.</p>
	
	<p class="center"><img src="images/combat_turtles/koch_curve.png" height="200px" title="Koch curve generated by Thue-Morse sequence."/></p>
	
	<p>But the built-in turtle objects in Python can't shoot missiles at each other, so I fixed that.</p>
	
	<h2>Technical Difficulties</h2>
	
	<p>My original intention was to <a href="https://www.w3schools.com/python/python_inheritance.asp">extend</a> the built-in turtle class to include a variety of gameplay-related methods for the player to use in their custom AI modules. In order to properly define the AI's behavior I opted for a discretized time scale so that the player could define, at any given moment, what their turtle should do in the next step. It turns out that the built-in module has a lot of overhead, which led to a lot of slowdown while attempting to execute many step events per second, and so I ended up having to program my own turtle module from scratch.</p>
	
	<p>Lacking access to the graphical capabilities of the built-in turtle class, I used <a href="https://docs.python.org/3/library/tkinter.html">Tkinter</a> to create the game window and all of the in-game graphics. In order to make the module as portable as possible I wanted to stick to using <i>only</i> modules from the Python Standard Library, which resulted in a few more challenges to work around. As far as I can tell there is no built-in command for rotating sprites in Tkinter, so it was not an option to include an image folder for all of the different turtle shapes. As a result I ended up defining all of the different turtle shapes as polygons, vertex-by-vertex, with the coordinates being translated and rotated between each step in order for the image to rotate with the turtle's heading.</p>
	
	<p class="center"><img src="images/combat_turtles/turtle_shapes.png" height="80px" title="Horrifically low-res turtle body shapes."/></p>
	
	<p>As a relative neophyte of Python, one of the most difficult parts of implementing this module was figuring out how to load the user-defined AI submodules in the <code>ai/</code> folder. Not knowing the number of submodules ahead of time, and not knowing their names, meant that I could not just hard-code them into an <code>import</code> statement, and as far as I know there is no straightforward way to get Python to import every class from every submodule in a folder. After much consulting with <a href="https://stackoverflow.com/">my experts</a>, the solution I ended up going with was to have the <code>ai</code> submodule's initialization script search through the folder for any and all AI files and then manually load their names into the module's <code>__all__</code> variable, and then <a href="https://docs.python.org/3/library/functions.html#eval">eval</a>uating a string that included the text version of the module's name.</p>
	
	<p class="center"><img src="https://github.com/adam-rumpf/combat-turtles/raw/master/images/coordinate_system.png" height="350px" title="Coordinate system for turtle graphics."/></p>
	
	<p>Handling angles and headings was also challenging for two reasons: The inverted vertical axis and the periodic nature of angles. Anyone familiar with computer graphics or game design will be familiar with an unusual quirk of how the coordinate system is defined. Normally mathematicians like to picture the positive \(y\)-direction as being up and the negative \(y\)-direction as being down, but in computer graphics it is the opposite. This is for largely historical reasons, since screens scan from top to bottom, but it is easy to forget to program everything upside-down relative to how you probably imagine it.</p>
	
	<p>This being an arena combat game seen from a top-down perspective, the inverted vertical axis was not really much of a concern except when it came to dealing with angles. While computer graphics usually invert the direction of the positive \(y\)-axis, they keep the usual orientations of the trigonometric functions the same, meaning (for example) that increasing the argument of the sine function from zero <i>decreases</i> the sine rather than <i>increasing</i> it, so it's pretty easy to accidentally reverse the effects of clockwise and counterclockwise rotation. In order to preserve the mathematical definitions of the trigonometric functions, and to preserve the idea of angle increase corresponding to counterclockwise rotation, I ended up having to invert the sign of the \(y\)-coordinate within any calculations involving angles (although some people might see that decision as a sine sign sin).</p>
	
	<p>In addition, when angles are used as navigational headings (as they are in turtle graphics), they have an inherently periodic nature. Adding one full rotation to any heading produces an equivalent heading, which requires some extra care when defining mathematical operations. Our standard idea of the "distance" between two numbers is simply their difference (i.e. absolute value of one minus the other), and numbers with a greater difference are intuitively "further apart" from each other, but that idea does not carry over to headings. For example, the standard numerical "difference" between \(1^\circ\) and \(359^\circ\) is just \(|1^\circ - 359^\circ| = 358^\circ\), which might intuitively lead us to conclude that the two headings are very different. However if we look at a compass we can see that they are really only \(2^\circ\) apart, since we can add \(2^\circ\) to \(359^\circ\) to get \(361^\circ\), which is equivalent to \(1^\circ\).</p>
	
	<p>In order to deal with these sorts of calculations I wrote a small utility module that defines an <code>Angle</code> class, with overloaded <a href="https://rszalski.github.io/magicmethods/">magic methods</a> to make them act more intuitively like headings for the purposes of numerical calculations. Among other things this class normalizes its heading between calculations to always produce a result within \(\pm 180^\circ\), and it defines comparison operations based on whether the smallest angle between two headings is clockwise or counterclockwise. The module was written for use in this project, but you can find a standalone version <a href="https://github.com/adam-rumpf/python-angles">here</a>, which you might find useful for other projects involving headings.</p>
	
	<footer>
		<hr>
		<p>Â© 2021 <a href="mailto:arumpf@hawk.iit.edu">Adam Rumpf</a></p>
	</footer>
</body>
</html>
